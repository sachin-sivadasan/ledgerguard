@startuml UC_Revenue_API_Simple
!theme plain
skinparam actorStyle awesome
skinparam packageStyle rectangle
skinparam defaultFontSize 14
skinparam usecaseFontSize 12
skinparam rectangleFontSize 16

title LedgerGuard Revenue API\nUse Case Overview

' ============================================
' ACTORS
' ============================================

actor "Your Client\n(App Developer)" as client #SkyBlue
actor "Client's App\nServer" as server #Gold
actor "Merchant\n(Store Owner)" as merchant #LightGreen

' ============================================
' MAIN SYSTEM
' ============================================

rectangle "LedgerGuard Revenue API" as system #LightYellow {

    ' Core API Operations
    package "Core Operations" #LightGreen {
        usecase "Query Subscription\nPayment Status" as UC1 #PaleGreen
        usecase "Query Usage\nBilling Status" as UC2 #PaleGreen
        usecase "Batch Status\nLookup" as UC3 #PaleGreen
    }

    ' Business Logic
    package "Business Actions" #LightCoral {
        usecase "Block Non-Paying\nMerchants" as UC4 #MistyRose
        usecase "Gate Premium\nFeatures" as UC5 #MistyRose
        usecase "Trigger Churn\nPrevention" as UC6 #MistyRose
    }

    ' Management
    package "Management" #LightBlue {
        usecase "Manage\nAPI Keys" as UC7 #AliceBlue
        usecase "View Audit\nLogs" as UC8 #AliceBlue
        usecase "Generate\nReports" as UC9 #AliceBlue
    }

    ' Integrations
    package "Integrations" #Lavender {
        usecase "Sync to\nCRM" as UC10 #Thistle
        usecase "Send\nAlerts" as UC11 #Thistle
        usecase "Export\nData" as UC12 #Thistle
    }
}

' ============================================
' RELATIONSHIPS
' ============================================

' Client (App Developer) manages their account
client --> UC7 : "setup"
client --> UC8 : "monitor"
client --> UC9 : "analyze"
client --> UC12 : "export"

' Client's server makes API calls
server --> UC1 : "real-time"
server --> UC2 : "real-time"
server --> UC3 : "batch"
server --> UC4 : "enforce"
server --> UC5 : "enforce"
server --> UC6 : "automate"
server --> UC10 : "sync"
server --> UC11 : "notify"

' Merchant triggers actions (indirectly)
merchant ..> server : "uses app"

' Dependencies
UC4 ..> UC1 : <<uses>>
UC5 ..> UC1 : <<uses>>
UC6 ..> UC3 : <<uses>>
UC10 ..> UC3 : <<uses>>

' ============================================
' NOTES
' ============================================

note right of UC1
  **Key Endpoint**
  GET /v1/subscription/{gid}/status

  Returns:
  - risk_state
  - is_paid_current_cycle
  - months_overdue
end note

note right of UC4
  **Primary Value**
  Your clients can block
  merchants who haven't
  paid for their app
end note

note bottom of system
  **API Authentication:** X-API-KEY header
  **Rate Limiting:** 60 req/min default (Redis-backed)
  **Phase 1:** REST API | **Phase 2:** + GraphQL
end note

@enduml
